---
title: 'Multi-signature transactions in a Peer-to-Peer World'
description: 'The quest to decentralize multi-signature coordination'
image:
  src: /img/blog/musig2-p2p.jpg
authors:
  - name: Matthew Urgero
    to: https://x.com/mcp011011
    avatar:
      src: /img/matthew_urgero.jpeg
date: 2025-11-13
badge:
  label: Technical Deep Dive
---

Multi-signature wallets promise shared custody and collaborative governance, but coordination breaks down without a central server. The usual solutions—trust a coordinator, run your own infrastructure, or coordinate manually—don't work for most users.

In Lotusia, we take a different approach. Participants discover each other automatically, coordinate cryptographically, and elect coordinators deterministically—without central coordinators or cumbersome out-of-band methodology.

## MuSig2

MuSig2 is a multi-signature scheme where multiple parties create a single Schnorr signature. Unlike traditional multi-sig (multiple public keys in a script), MuSig2 produces an aggregated public key and single signature indistinguishable from a standard transaction—a three-person treasury appears on-chain like a single-person payment.

Traditional P2SH multi-sig for three participants needs 99 bytes of public keys and 210 bytes of signatures. MuSig2 with Taproot uses 33 bytes and 64 bytes—83% smaller. Security is provably sound under the [discrete logarithm assumption](https://en.wikipedia.org/wiki/Discrete_logarithm), preventing rogue key attacks through key aggregation coefficients and nonce reuse through session management.

The coordination problem: MuSig2 requires two communication rounds—nonce exchange, partial signature exchange, aggregation, and broadcasting. Key challenges:

- How do wallets discover signing sessions?
- How do participants authenticate messages?
- How do you prevent replay attacks?
- Who broadcasts the final transaction?
- What happens when they refuse or crash?

## The Solution

We combined three proven distributed systems patterns:

**Discovery**: DHT for persistent session announcements, GossipSub pub/sub for instant notifications (10-100ms), direct P2P for signing.

**Security**: Cryptographically signed messages, rate limiting, peer reputation tracking, protocol phase enforcement, and optional burn-based identity that anchors to blockchain transactions—not signing keys—enabling key rotation without reputation reset.

**Coordinator election**: All participants run the same deterministic algorithm on the same public keys—everyone arrives at the same coordinator with no voting. Automatic failover handles up to N-1 coordinator failures.

This infrastructure enables multi-sig treasuries (2-of-2 DAOs to 10-of-10 councils), payment channels with automatic failover, true P2P atomic swaps, vaults with emergency recovery, and SwapSig—our CoinJoin-equivalent privacy protocol.

## Implementation Status

The implementation works. 91+ tests pass. Connection management separates general P2P connections from session-specific coordination, so wallet connection limits won't block multi-sig sessions.

The aggregated MuSig2 public key becomes the Taproot internal key—a 3-of-3 key path spend looks like someone buying coffee. Complex script trees remain hidden until spent via script path.

The implementation lives in [lotus-lib](https://github.com/LotusiaStewardship/lotus-lib). Working examples demonstrate 2-of-2 signing, multi-party coordinator election, and Taproot integration. The [documentation](https://github.com/LotusiaStewardship/lotus-lib/blob/master/lib/p2p/musig2/README.md) covers architecture, security, and API details.

We're seeking feedback from developers. Install, experiment, break things, report issues.

## The Path Forward

MuSig2 brought multi-signatures to Schnorr with strong security guarantees, but coordinating participants remained a problem that has historically been solved through centralization.

Technology should enhance human relationships, not replace them. Multi-sig treasuries work when humans make governance decisions and protocols handle technical coordination. P2P coordination makes the technical part invisible.

The code works. The tests pass. Now comes what matters: real-world use, stress testing, edge case discovery. Slow and steady. One careful protocol at a time.

---

**Resources:**

- [MuSig2 P2P Documentation](https://github.com/LotusiaStewardship/lotus-lib/tree/master/lib/p2p/musig2) - Complete API reference and examples
- [lotus-lib Repository](https://github.com/LotusiaStewardship/lotus-lib) - Source code and test suite
- [BIP327 Specification](https://github.com/bitcoin/bips/blob/master/bip-0327.mediawiki) - MuSig2 protocol details
- [Lotus Documentation](https://lotusia.org/docs) - Blockchain and developer guides

**Community:**

- [Discord](https://discord.gg/fZrFa3vf) - Real-time discussion
- [Telegram](https://t.me/LotusiaDiscourse) - Community discourse
- [GitHub Issues](https://github.com/LotusiaStewardship/lotus-lib/issues) - Technical questions
