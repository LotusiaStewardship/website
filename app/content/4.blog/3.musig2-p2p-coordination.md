---
title: 'Multi-signature transactions in a Peer-to-Peer World'
description: 'The quest to decentralize multi-signature coordination'
image:
  src: /img/blog/musig2-p2p.jpg
authors:
  - name: Matthew Urgero
    to: https://x.com/mcp011011
    avatar:
      src: /img/matthew_urgero.jpeg
date: 2025-11-13
badge:
  label: Technical Deep Dive
---

Building decentralized systems means confronting uncomfortable truths. Multi-signature wallets promise shared custody and collaborative governance, but they break down the moment participants try to coordinate without a central server. Someone needs to collect nonces. Someone needs to aggregate signatures. Someone needs to broadcast the final transaction.

The usual answer is to trust a coordinator, run your own infrastructure, or handle everything manually. Running infrastructure is impractical for most users. Manual coordination doesn't scale beyond small, stable groups. So in practice, everyone defaults to trusted coordinators, which contradicts the entire point of decentralization.

So we built something different. The MuSig2 P2P implementation in lotus-lib explores what becomes possible when you refuse to compromise on decentralization. Multi-party signatures discover each other automatically, coordinate cryptographically, and elect coordinators deterministically, with no central servers, no manual processes, and no trust required beyond the math.

## Why MuSig2 Matters

When Lotus reactivated Taproot in the 2nd Samuel epoch, we weren't just enabling a feature; we were opening a path toward genuine on-chain privacy. Taproot's key insight: make complex transactions look identical to simple ones.

MuSig2 completes that vision for multi-party signatures. Instead of broadcasting multiple public keys and signatures on-chain, participants aggregate everything into what appears to be a single-signature transaction. A 3-of-3 treasury spend looks identical to someone buying coffee. No one watching the blockchain can tell the difference.

The efficiency gains are substantial. Traditional P2SH multi-sig for three participants: 99 bytes of public keys, roughly 210 bytes of signatures. MuSig2 with Taproot: 33 bytes, 64 bytes. That's 83% smaller, meaning lower fees, less blockchain bloat, and better privacy.

The security is provably sound under the discrete logarithm assumption. MuSig2 prevents rogue key attacks through key aggregation coefficients and prevents nonce reuse through careful session management.

But here's the catch: MuSig2 requires coordination. Two rounds of communication between all participants: nonce exchange, partial signature exchange, collection, aggregation, and broadcasting. In a decentralized context, that "someone" who orchestrates all this becomes a problem.

## Encountering the Problem

Picture three people running a multi-sig treasury. Alice initiates a spend. Bob and Charlie need to participate. Without a central server, how do they even find each other?

Alice could manually send Bob and Charlie the transaction details, they exchange nonces through email or messaging apps, exchange partial signatures, aggregate them, and broadcast. This works for three people who know each other, but it falls apart for dynamic groups or larger councils where participants change.

The traditional solution: deploy a coordination server. It collects nonces, tracks partial signatures, aggregates the final result, and broadcasts the transaction. Problem solved, except now you've introduced a central point of failure and trust. The server sees everything. If it goes down, coordination stops. If it's compromised, privacy disappears.

Every step raises questions that don't have obvious answers:

- How do wallets discover signing sessions without a directory server?
- How do participants know messages are authentic without a trusted mediator?
- How do you prevent replay attacks without session state tracking?
- Who builds and broadcasts the final transaction?
- What happens when that person refuses or crashes?

These questions aren't academic. They're why most multi-sig implementations either require manual coordination or trusted servers.

## Building the Solution

We started by recognizing that distributed systems had already solved similar problems: Kademlia DHT for content discovery, GossipSub for real-time pub/sub, Byzantine consensus for agreement without trust. The question wasn't whether decentralized coordination was possible; it was how to apply these patterns to multi-party signatures.

**Discovery became a multi-channel problem**. A distributed hash table stores session announcements persistently. When Alice creates a signing session, she announces it to 20 DHT nodes, and Bob and Charlie query the DHT to discover it. But DHT queries are slow (seconds), so we added real-time pub/sub through GossipSub. Wallets subscribe to topics like "swap signers" and receive instant notifications (10-100ms latency). Once participants find each other, direct peer-to-peer connections handle the actual signing. The result: distributed state and pub/sub coordination with no central directory or server.

**Security required multiple layers**. Every message carries a cryptographic signature; you can't fake a nonce share or partial signature without the corresponding private key. Rate limiting (one advertisement per 60 seconds) prevents spam. Peer reputation tracking identifies patterns, where repeated failures, invalid signatures, and protocol violations accumulate into scores that can trigger automatic bans. Protocol phase enforcement ensures you can't send a partial signature before exchanging nonces. An optional burn-based identity system adds economic cost to Sybil attacks: register by burning XPI on-chain, creating immutable proof tied to the blockchain rather than your signing key. This means key rotation doesn't reset your reputation.

**Coordinator election solved the broadcast problem without adding coordination overhead**. All participants independently run the same deterministic algorithm on the same set of public keys, and everyone arrives at the same coordinator with no voting, no messages, and no consensus round required. If that coordinator fails to broadcast within a timeout, automatic failover moves to the next in line. The failover sequence itself is deterministic, so everyone independently knows the backup order. The system works through up to N-1 coordinator failures (Byzantine fault tolerance).

The elegant part: we didn't invent new cryptography or consensus mechanisms. We took proven techniques from distributed systems and applied them to a new context.

## What This Unlocks

The immediate benefit: organizations can run multi-sig treasuries without coordination headaches. No more scheduling calls to collect signatures. No more manually passing around partial signatures through messaging apps. Participants discover each other automatically. The protocol handles coordination. The elected coordinator broadcasts. It works whether you're a 2-of-2 DAO or a 10-of-10 stewardship council.

But the deeper implications matter more.

Payment channels become simpler. Lightning-style channels require multiple parties to sign state updates. With P2P coordination, this happens seamlessly with no intermediary servers and automatic failover if someone goes offline mid-protocol. The coordination layer becomes invisible infrastructure.

Atomic swaps get cleaner. Traditional implementations rely on smart contracts or escrow services. MuSig2 enables true peer-to-peer atomic swaps with cryptographic security replacing contractual trust. Coordinator election ensures one party broadcasts while the other simply signs: no smart contract, no escrow, just coordinated signatures.

Vaults with recovery paths become practical. Time-locked vaults with emergency recovery: the primary keyset has its deterministic coordinator, the emergency keyset has a different one. Both work trustlessly without requiring central coordination for either spending path.

These patterns extend beyond simple multi-sig. SwapSig, our CoinJoin-equivalent privacy protocol, uses the same coordination infrastructure with shared MuSig2 outputs, circular rotation, and transaction graph unlinkage, all coordinated peer-to-peer. It's the foundation for an entire class of privacy-preserving protocols.

## Where We Are

The implementation works. 91+ tests pass, covering everything from basic 2-of-2 signing to complex coordinator failover scenarios. Automatic session cleanup prevents memory leaks in long-running nodes. Replay protection uses per-signer sequence numbers. Signature verification happens at receipt time, not during aggregation; trust-free from the ground up.

We thought carefully about practical deployment. Connection management separates general P2P connections (for network health) from session-specific connections (for signing coordination). Your wallet's connection limits won't block multi-sig sessions. The optional burn-based identity system adds economic cost to Sybil attacks while enabling key rotation; identity anchors to an immutable burn transaction, not your mutable signing key.

The integration with Taproot creates something subtle but powerful. The aggregated MuSig2 public key becomes the Taproot internal key. When spending via the key path, the signature is indistinguishable from single-sig on-chain. A 3-of-3 key path spend looks identical to someone buying coffee. Complex script trees (time locks, hash locks, alternate keysets) remain hidden until spent via script path. Privacy through indistinguishability.

## Why This Matters

This isn't just about removing servers from multi-sig. It's about what becomes possible when you refuse to compromise on decentralization.

Traditional multi-sig forces a choice: trust a coordinator, or handle everything manually. Threshold schemes require dealer-based setup or carefully timed key generation. Smart contract solutions lock you into specific chains and charge gas for coordination. Each approach makes a trade-off.

MuSig2 P2P doesn't. Cryptography replaces trust. Deterministic algorithms replace central coordination. Peer-to-peer networking replaces servers. The result: automatic coordination without trusted parties, central points of failure, or manual processes.

This aligns with what Lotus represents. Technology should enhance human relationships, not replace them. Multi-sig treasuries work better when humans make governance decisions ("should we spend this?") and protocols handle technical coordination ("how do we sign?"). P2P coordination makes the technical part invisible, letting humans focus on what matters: the relationships, the governance, the shared purpose.

## Building With It

The implementation lives in [lotus-lib](https://github.com/LotusiaStewardship/lotus-lib). Working examples demonstrate 2-of-2 signing, multi-party coordinator election, Taproot integration. The [documentation](https://github.com/LotusiaStewardship/lotus-lib/blob/master/lib/p2p/musig2/README.md) covers architecture, security considerations, API details.

We're seeking feedback from developers willing to build with these patterns. Install, experiment, break things, report issues. This is new territory. The more people testing in different contexts, the better the system becomes.

## The Path Forward

Multi-signature schemes have existed for decades. MuSig2 brought them to Schnorr signatures with strong security and efficiency guarantees. But coordination remained the bottleneck: the place where theory met practice and usually compromised.

We built this because compromise wasn't acceptable. The code works. The tests pass. The cryptography is sound. Now comes the part that matters: using it, stress-testing it, discovering edge cases, refining based on real-world feedback.

This is how good infrastructure gets built: carefully and incrementally, with confidence in the design but humility about deployment, testing thoroughly and learning continuously.

Slow and steady builds the future. One careful protocol at a time.

---

**Resources:**

- [MuSig2 P2P Documentation](https://github.com/LotusiaStewardship/lotus-lib/tree/master/lib/p2p/musig2) - Complete API reference and examples
- [lotus-lib Repository](https://github.com/LotusiaStewardship/lotus-lib) - Source code and test suite
- [BIP327 Specification](https://github.com/bitcoin/bips/blob/master/bip-0327.mediawiki) - MuSig2 protocol details
- [Lotus Documentation](https://lotusia.org/docs) - Blockchain and developer guides

**Community:**

- [Discord](https://discord.gg/fZrFa3vf) - Real-time discussion
- [Telegram](https://t.me/LotusiaDiscourse) - Community discourse
- [GitHub Issues](https://github.com/LotusiaStewardship/lotus-lib/issues) - Technical questions
